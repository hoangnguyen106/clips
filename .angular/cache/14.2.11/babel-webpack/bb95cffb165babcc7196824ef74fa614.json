{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/nguye/Documents/GitHub/clips/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/clip.service\";\nimport * as i3 from \"src/app/services/modal.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"../edit/edit.component\";\n\nconst _c0 = function (a2) {\n  return [\"/\", \"clip\", a2];\n};\n\nfunction ManageComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"a\", 11);\n    i0.ɵɵelement(2, \"img\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 13)(4, \"a\", 14);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"a\", 15);\n    i0.ɵɵlistener(\"click\", function ManageComponent_div_11_Template_a_click_6_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const clip_r1 = restoredCtx.$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.copyToClipboard($event, clip_r1.docID));\n    });\n    i0.ɵɵtext(7, \" Copy Link \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 16)(9, \"a\", 17);\n    i0.ɵɵlistener(\"click\", function ManageComponent_div_11_Template_a_click_9_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const clip_r1 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.openModal($event, clip_r1));\n    });\n    i0.ɵɵelementStart(10, \"span\", 18);\n    i0.ɵɵtext(11, \"build\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"a\", 19);\n    i0.ɵɵlistener(\"click\", function ManageComponent_div_11_Template_a_click_12_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const clip_r1 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.deleteClip($event, clip_r1));\n    });\n    i0.ɵɵelementStart(13, \"span\", 18);\n    i0.ɵɵtext(14, \"delete\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const clip_r1 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(4, _c0, clip_r1.docID));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", clip_r1.screenshotURL, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(6, _c0, clip_r1.docID));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", clip_r1.title, \" \");\n  }\n}\n\nexport class ManageComponent {\n  constructor(route, router, clipService, modal) {\n    this.route = route;\n    this.router = router;\n    this.clipService = clipService;\n    this.modal = modal;\n    this.videoOrder = '1';\n    this.clips = [];\n    this.activeClip = null;\n    this.sort$ = new BehaviorSubject(this.videoOrder);\n  }\n\n  ngOnInit() {\n    this.route.queryParamMap.subscribe(params => {\n      this.videoOrder = params.sort == '2' ? params.sort : '1';\n      this.sort$.next(this.videoOrder);\n    });\n    this.clipService.getUserClips(this.sort$).subscribe(docs => {\n      this.clips = [];\n      docs.forEach(doc => {\n        this.clips.push(Object.assign({\n          docID: doc.id\n        }, doc.data()));\n      });\n    });\n  } // Sort theo element\n\n\n  sort(event) {\n    const {\n      value\n    } = event.target;\n    this.router.navigate([], {\n      relativeTo: this.route,\n      queryParams: {\n        sort: value\n      }\n    });\n  } // Modal chỉnh sửa nội dung clip\n\n\n  openModal($event, clip) {\n    $event.preventDefault();\n    this.activeClip = clip;\n    this.modal.toggleModal('editClip');\n  } // Cập nhật title clip\n\n\n  update($event) {\n    this.clips.forEach((element, index) => {\n      if (element.docID == $event.docID) {\n        this.clips[index].title = $event.title;\n      }\n    });\n  } //Xóa clip và thông tin\n\n\n  deleteClip($event, clip) {\n    $event.preventDefault();\n    this.clipService.deleteClip(clip);\n    this.clips.forEach((element, index) => {\n      if (element.docID == clip.docID) {\n        this.clips.splice(index, 1);\n      }\n    });\n  }\n\n  copyToClipboard($event, docID) {\n    return _asyncToGenerator(function* () {\n      $event.preventDefault();\n\n      if (!docID) {\n        return;\n      }\n\n      const url = `${location.origin}/clip/${docID}`;\n      yield navigator.clipboard.writeText(url);\n      alert('Link copied!!!');\n    })();\n  }\n\n}\n\nManageComponent.ɵfac = function ManageComponent_Factory(t) {\n  return new (t || ManageComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ClipService), i0.ɵɵdirectiveInject(i3.ModalService));\n};\n\nManageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ManageComponent,\n  selectors: [[\"app-manage\"]],\n  decls: 13,\n  vars: 4,\n  consts: [[1, \"container\", \"mx-auto\", \"my-8\", \"bg-secondary\", \"p-6\"], [1, \"rounded\", \"relative\", \"flex\", \"justify-between\"], [\"routerLink\", \"/upload\", 1, \"bg-indigo-400\", \"text-white\", \"py-4\", \"px-10\", \"text-xl\"], [1, \"text-black\", \"px-8\", \"text-xl\", \"outline-none\", \"appearance-none\", 3, \"change\"], [\"value\", \"1\", 3, \"selected\"], [\"value\", \"2\", 3, \"selected\"], [1, \"container\", \"mx-auto\", \"my-8\"], [1, \"grid\", \"grid-cols-1\", \"lg:grid-cols-3\", \"gap-4\"], [\"class\", \"mt-6 rounded-tl-2xl rounded-br-2xl shadow-xl bg-secondary flex flex-col justify-start\", 4, \"ngFor\", \"ngForOf\"], [3, \"activeClip\", \"update\"], [1, \"mt-6\", \"rounded-tl-2xl\", \"rounded-br-2xl\", \"shadow-xl\", \"bg-secondary\", \"flex\", \"flex-col\", \"justify-start\"], [3, \"routerLink\"], [\"crossorigin\", \"\", 1, \"card-img-top\", \"rounded-tl-2xl\", \"w-full\", 3, \"src\"], [1, \"p-6\", \"text-2xl\"], [1, \"font-bold\", \"mb-2\", 3, \"routerLink\"], [\"href\", \"#\", 1, \"bg-gray-400\", \"text-white\", \"px-2\", \"py-1\", \"ml-2\", \"text-sm\", \"rounded\", 3, \"click\"], [1, \"flex\", \"text-center\", \"text-2xl\", \"bg-gray-800\", \"p-2\", \"mt-auto\"], [\"href\", \"#\", 1, \"flex-1\", \"p-2\", \"border-right\", \"border-r-2\", \"border-gray-700\", \"transition\", \"hover:text-indigo-400\", 3, \"click\"], [1, \"material-icons\", \"text-base\"], [\"href\", \"#\", 1, \"flex-1\", \"p-2\", \"rounded-br-2xl\", \"transition\", \"hover:text-indigo-400\", 3, \"click\"]],\n  template: function ManageComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"section\", 0)(1, \"div\", 1)(2, \"a\", 2);\n      i0.ɵɵtext(3, \" Upload Videos \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"select\", 3);\n      i0.ɵɵlistener(\"change\", function ManageComponent_Template_select_change_4_listener($event) {\n        return ctx.sort($event);\n      });\n      i0.ɵɵelementStart(5, \"option\", 4);\n      i0.ɵɵtext(6, \"Recent Uploads\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"option\", 5);\n      i0.ɵɵtext(8, \"Oldest Uploads\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(9, \"div\", 6)(10, \"div\", 7);\n      i0.ɵɵtemplate(11, ManageComponent_div_11_Template, 15, 8, \"div\", 8);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(12, \"app-edit\", 9);\n      i0.ɵɵlistener(\"update\", function ManageComponent_Template_app_edit_update_12_listener($event) {\n        return ctx.update($event);\n      });\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"selected\", ctx.videoOrder === \"1\");\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"selected\", ctx.videoOrder === \"2\");\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.clips);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"activeClip\", ctx.activeClip);\n    }\n  },\n  dependencies: [i4.NgForOf, i1.RouterLinkWithHref, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i6.EditComponent],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJtYW5hZ2UuY29tcG9uZW50LmNzcyJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["BehaviorSubject","i0","ManageComponent","constructor","route","router","clipService","modal","sort$","videoOrder","ngOnInit","queryParamMap","subscribe","params","sort","next","getUserClips","docs","clips","forEach","doc","push","Object","docID","id","data","event","value","target","navigate","relativeTo","queryParams","openModal","$event","clip","preventDefault","activeClip","toggleModal","update","element","index","title","deleteClip","splice","copyToClipboard","url","location","origin","navigator","clipboard","writeText","alert","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\nguye\\Documents\\GitHub\\clips\\src\\app\\video\\manage\\manage.component.ts","C:\\Users\\nguye\\Documents\\GitHub\\clips\\src\\app\\video\\manage\\manage.component.html"],"sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Params, Router } from '@angular/router';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport IClip from 'src/app/models/clip.model';\r\nimport { ClipService } from 'src/app/services/clip.service';\r\nimport { ModalService } from 'src/app/services/modal.service';\r\n\r\n@Component({\r\n  selector: 'app-manage',\r\n  templateUrl: './manage.component.html',\r\n  styleUrls: ['./manage.component.css'],\r\n})\r\nexport class ManageComponent implements OnInit {\r\n  videoOrder = '1';\r\n  clips: IClip[] = [];\r\n  activeClip: IClip | null = null;\r\n  sort$: BehaviorSubject<string>;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private clipService: ClipService,\r\n    private modal: ModalService\r\n  ) {\r\n    this.sort$ = new BehaviorSubject(this.videoOrder);\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.route.queryParamMap.subscribe((params: Params) => {\r\n      this.videoOrder = params.sort == '2' ? params.sort : '1';\r\n      this.sort$.next(this.videoOrder);\r\n    });\r\n    this.clipService.getUserClips(this.sort$).subscribe((docs) => {\r\n      this.clips = [];\r\n\r\n      docs.forEach((doc) => {\r\n        this.clips.push({\r\n          docID: doc.id,\r\n          ...doc.data(),\r\n        });\r\n      });\r\n    });\r\n  }\r\n  // Sort theo element\r\n  sort(event: Event) {\r\n    const { value } = event.target as HTMLSelectElement;\r\n    this.router.navigate([], {\r\n      relativeTo: this.route,\r\n      queryParams: {\r\n        sort: value,\r\n      },\r\n    });\r\n  }\r\n  // Modal chỉnh sửa nội dung clip\r\n  openModal($event: Event, clip: IClip) {\r\n    $event.preventDefault();\r\n\r\n    this.activeClip = clip;\r\n\r\n    this.modal.toggleModal('editClip');\r\n  }\r\n  // Cập nhật title clip\r\n  update($event: IClip) {\r\n    this.clips.forEach((element, index) => {\r\n      if (element.docID == $event.docID) {\r\n        this.clips[index].title = $event.title;\r\n      }\r\n    });\r\n  }\r\n  //Xóa clip và thông tin\r\n  deleteClip($event: Event, clip: IClip) {\r\n    $event.preventDefault();\r\n\r\n    this.clipService.deleteClip(clip);\r\n\r\n    this.clips.forEach((element, index) => {\r\n      if (element.docID == clip.docID) {\r\n        this.clips.splice(index, 1);\r\n      }\r\n    });\r\n  }\r\n  async copyToClipboard($event: MouseEvent, docID: string | undefined) {\r\n    $event.preventDefault();\r\n\r\n    if (!docID) {\r\n      return;\r\n    }\r\n\r\n    const url = `${location.origin}/clip/${docID}`;\r\n\r\n    await navigator.clipboard.writeText(url);\r\n    alert('Link copied!!!');\r\n  }\r\n}\r\n","<!-- Top Bar -->\r\n<section class=\"container mx-auto my-8 bg-secondary p-6\">\r\n  <div class=\"rounded relative flex justify-between\">\r\n    <a routerLink=\"/upload\" class=\"bg-indigo-400 text-white py-4 px-10 text-xl\">\r\n      Upload Videos\r\n    </a>\r\n    <!-- Sort Videos -->\r\n    <select\r\n      (change)=\"sort($event)\"\r\n      class=\"text-black px-8 text-xl outline-none appearance-none\"\r\n    >\r\n      <option value=\"1\" [selected]=\"videoOrder === '1'\">Recent Uploads</option>\r\n      <option value=\"2\" [selected]=\"videoOrder === '2'\">Oldest Uploads</option>\r\n    </select>\r\n  </div>\r\n</section>\r\n\r\n<!-- User's Video Section -->\r\n<div class=\"container mx-auto my-8\">\r\n  <!-- Video List -->\r\n  <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\r\n    <div\r\n      *ngFor=\"let clip of clips\"\r\n      class=\"mt-6 rounded-tl-2xl rounded-br-2xl shadow-xl bg-secondary flex flex-col justify-start\"\r\n    >\r\n      <!-- Image -->\r\n      <a [routerLink]=\"['/', 'clip', clip.docID]\">\r\n        <img\r\n          class=\"card-img-top rounded-tl-2xl w-full\"\r\n          [src]=\"clip.screenshotURL\"\r\n          crossorigin\r\n        />\r\n      </a>\r\n\r\n      <!-- Body -->\r\n      <div class=\"p-6 text-2xl\">\r\n        <!-- Link -->\r\n        <a [routerLink]=\"['/', 'clip', clip.docID]\" class=\"font-bold mb-2\">\r\n          {{ clip.title }}\r\n        </a>\r\n        <a\r\n          (click)=\"copyToClipboard($event, clip.docID)\"\r\n          href=\"#\"\r\n          class=\"bg-gray-400 text-white px-2 py-1 ml-2 text-sm rounded\"\r\n        >\r\n          Copy Link\r\n        </a>\r\n      </div>\r\n\r\n      <!-- Actions -->\r\n      <div class=\"flex text-center text-2xl bg-gray-800 p-2 mt-auto\">\r\n        <a\r\n          (click)=\"openModal($event, clip)\"\r\n          href=\"#\"\r\n          class=\"flex-1 p-2 border-right border-r-2 border-gray-700 transition hover:text-indigo-400\"\r\n        >\r\n          <span class=\"material-icons text-base\">build</span>\r\n        </a>\r\n        <a\r\n          (click)=\"deleteClip($event, clip)\"\r\n          href=\"#\"\r\n          class=\"flex-1 p-2 rounded-br-2xl transition hover:text-indigo-400\"\r\n        >\r\n          <span class=\"material-icons text-base\">delete</span>\r\n        </a>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<app-edit [activeClip]=\"activeClip\" (update)=\"update($event)\"></app-edit>\r\n"]},"metadata":{},"sourceType":"module"}